@if (isVisible && product) {
  <div class="modal-overlay" (click)="closeModal()">
    <div class="modal-content" (click)="$event.stopPropagation()">
      <button class="close-button" (click)="closeModal()" aria-label="Cerrar">
        ×
      </button>

      <div class="modal__header">
        <h2 class="modal__title">{{ product.title }}</h2>
        <p class="modal__price">
          ${{ product.price | number:'1.2-2' }} {{ product.currency }}
        </p>
      </div>

      <div class="modal__body">
        <p><strong>Disponibilidad:</strong> {{ product.availability }}</p>

        <h3 class="details-title">Especificaciones Técnicas</h3>

        <ul class="product-details-list">
          @for (key of detailKeys; track key; let i = $index) {
            @if (i < 2 || showFullDetails) {
              <li>
                <strong>{{ key }}:</strong> {{ product.details[key] }}
              </li>
            }
          } @empty {
            <li class="empty">No hay especificaciones disponibles.</li>
          }
        </ul>

        @if (detailKeys.length > 2) {
          <button class="toggle-button" (click)="toggleDetails()">
            {{ showFullDetails
              ? 'Ocultar Detalles'
              : 'Mostrar Todos los Detalles (+' + (detailKeys.length - 2) + ')'
            }}
          </button>
        }
      </div>

      <a
        class="detail-link"
        [routerLink]="getProductDetailLink(product.id)"
        (click)="closeModal()">
        Ver Detalle Completo
      </a>

      <div class="modal-actions">
        <button class="add-to-cart" (click)="closeModal()">Añadir al Carrito</button>
        <button class="continue" (click)="closeModal()">Cerrar Vista</button>
      </div>
    </div>
  </div>
}